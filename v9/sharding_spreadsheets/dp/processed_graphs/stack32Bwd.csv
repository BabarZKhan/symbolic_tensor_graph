stack0_mha_d_norm,N,"B/bp,Seq,H,D",1,stack0_ffn_d_x00,stack0_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack0_mha_d_res,N,"B/bp,Seq,H,D",1,stack0_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack0_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack0_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack0_mha_d_qkv,stack0_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack0_mha_d_v,N,"B/bp,Seq,H,D",1,stack0_mha_d_qkv,stack0_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack0_mha_d_k,N,"B/bp,Seq,H,D",1,stack0_mha_d_qk,stack0_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack0_mha_d_q,N,"B/bp,Seq,H,D",1,stack0_mha_d_qk,stack0_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack0_mha_d_wv,N,"H,D,D",1,stack0_mha_d_v,stack0_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack0_mha_d_wk,N,"H,D,D",1,stack0_mha_d_k,stack0_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack0_mha_d_wq,N,"H,D,D",1,stack0_mha_d_q,stack0_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack0_mha_d_x0,N,"B/bp,Seq,H,D",1,stack0_mha_d_v,stack0_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack0_mha_d_x1,N,"B/bp,Seq,H,D",1,stack0_mha_d_k,stack0_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack0_mha_d_x2,N,"B/bp,Seq,H,D",1,stack0_mha_d_q,stack0_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack0_mha_d_x3,N,"B/bp,Seq,H,D",1,stack0_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_mha_d_x01,N,"B/bp,Seq,H,D",1,stack0_mha_d_x0,stack0_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_mha_d_x23,N,"B/bp,Seq,H,D",1,stack0_mha_d_x2,stack0_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_mha_d_x,N,"B/bp,Seq,H,D",1,stack0_mha_d_x01,stack0_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack1_mha_d_x01,stack1_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack0_ffn_d_res,N,"B/bp,Seq,D*H",1,stack0_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack0_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack0_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack0_ffn_d_w2,N,"DF*H,D*H",1,stack0_ffn_d_x2,stack0_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack0_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack0_ffn_d_x2,stack0_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack0_ffn_d_w1,N,"D*H,DF*H",1,stack0_ffn_d_x2,stack0_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack0_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack0_ffn_d_x1,stack0_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack0_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack0_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack1_mha_d_norm,N,"B/bp,Seq,H,D",1,stack1_ffn_d_x00,stack1_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack1_mha_d_res,N,"B/bp,Seq,H,D",1,stack1_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack1_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack1_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack1_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack1_mha_d_qkv,stack1_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack1_mha_d_v,N,"B/bp,Seq,H,D",1,stack1_mha_d_qkv,stack1_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack1_mha_d_k,N,"B/bp,Seq,H,D",1,stack1_mha_d_qk,stack1_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack1_mha_d_q,N,"B/bp,Seq,H,D",1,stack1_mha_d_qk,stack1_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack1_mha_d_wv,N,"H,D,D",1,stack1_mha_d_v,stack1_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack1_mha_d_wk,N,"H,D,D",1,stack1_mha_d_k,stack1_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack1_mha_d_wq,N,"H,D,D",1,stack1_mha_d_q,stack1_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack1_mha_d_x0,N,"B/bp,Seq,H,D",1,stack1_mha_d_v,stack1_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack1_mha_d_x1,N,"B/bp,Seq,H,D",1,stack1_mha_d_k,stack1_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack1_mha_d_x2,N,"B/bp,Seq,H,D",1,stack1_mha_d_q,stack1_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack1_mha_d_x3,N,"B/bp,Seq,H,D",1,stack1_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack1_mha_d_x01,N,"B/bp,Seq,H,D",1,stack1_mha_d_x0,stack1_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack1_mha_d_x23,N,"B/bp,Seq,H,D",1,stack1_mha_d_x2,stack1_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack1_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack2_mha_d_x01,stack2_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack1_ffn_d_res,N,"B/bp,Seq,D*H",1,stack1_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack1_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack1_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack1_ffn_d_w2,N,"DF*H,D*H",1,stack1_ffn_d_x2,stack1_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack1_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack1_ffn_d_x2,stack1_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack1_ffn_d_w1,N,"D*H,DF*H",1,stack1_ffn_d_x2,stack1_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack1_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack1_ffn_d_x1,stack1_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack1_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack1_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack2_mha_d_norm,N,"B/bp,Seq,H,D",1,stack2_ffn_d_x00,stack2_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack2_mha_d_res,N,"B/bp,Seq,H,D",1,stack2_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack2_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack2_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack2_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack2_mha_d_qkv,stack2_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack2_mha_d_v,N,"B/bp,Seq,H,D",1,stack2_mha_d_qkv,stack2_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack2_mha_d_k,N,"B/bp,Seq,H,D",1,stack2_mha_d_qk,stack2_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack2_mha_d_q,N,"B/bp,Seq,H,D",1,stack2_mha_d_qk,stack2_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack2_mha_d_wv,N,"H,D,D",1,stack2_mha_d_v,stack2_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack2_mha_d_wk,N,"H,D,D",1,stack2_mha_d_k,stack2_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack2_mha_d_wq,N,"H,D,D",1,stack2_mha_d_q,stack2_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack2_mha_d_x0,N,"B/bp,Seq,H,D",1,stack2_mha_d_v,stack2_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack2_mha_d_x1,N,"B/bp,Seq,H,D",1,stack2_mha_d_k,stack2_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack2_mha_d_x2,N,"B/bp,Seq,H,D",1,stack2_mha_d_q,stack2_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack2_mha_d_x3,N,"B/bp,Seq,H,D",1,stack2_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack2_mha_d_x01,N,"B/bp,Seq,H,D",1,stack2_mha_d_x0,stack2_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack2_mha_d_x23,N,"B/bp,Seq,H,D",1,stack2_mha_d_x2,stack2_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack2_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack3_mha_d_x01,stack3_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack2_ffn_d_res,N,"B/bp,Seq,D*H",1,stack2_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack2_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack2_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack2_ffn_d_w2,N,"DF*H,D*H",1,stack2_ffn_d_x2,stack2_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack2_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack2_ffn_d_x2,stack2_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack2_ffn_d_w1,N,"D*H,DF*H",1,stack2_ffn_d_x2,stack2_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack2_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack2_ffn_d_x1,stack2_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack2_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack2_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack3_mha_d_norm,N,"B/bp,Seq,H,D",1,stack3_ffn_d_x00,stack3_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack3_mha_d_res,N,"B/bp,Seq,H,D",1,stack3_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack3_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack3_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack3_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack3_mha_d_qkv,stack3_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack3_mha_d_v,N,"B/bp,Seq,H,D",1,stack3_mha_d_qkv,stack3_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack3_mha_d_k,N,"B/bp,Seq,H,D",1,stack3_mha_d_qk,stack3_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack3_mha_d_q,N,"B/bp,Seq,H,D",1,stack3_mha_d_qk,stack3_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack3_mha_d_wv,N,"H,D,D",1,stack3_mha_d_v,stack3_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack3_mha_d_wk,N,"H,D,D",1,stack3_mha_d_k,stack3_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack3_mha_d_wq,N,"H,D,D",1,stack3_mha_d_q,stack3_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack3_mha_d_x0,N,"B/bp,Seq,H,D",1,stack3_mha_d_v,stack3_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack3_mha_d_x1,N,"B/bp,Seq,H,D",1,stack3_mha_d_k,stack3_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack3_mha_d_x2,N,"B/bp,Seq,H,D",1,stack3_mha_d_q,stack3_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack3_mha_d_x3,N,"B/bp,Seq,H,D",1,stack3_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack3_mha_d_x01,N,"B/bp,Seq,H,D",1,stack3_mha_d_x0,stack3_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack3_mha_d_x23,N,"B/bp,Seq,H,D",1,stack3_mha_d_x2,stack3_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack3_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack4_mha_d_x01,stack4_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack3_ffn_d_res,N,"B/bp,Seq,D*H",1,stack3_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack3_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack3_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack3_ffn_d_w2,N,"DF*H,D*H",1,stack3_ffn_d_x2,stack3_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack3_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack3_ffn_d_x2,stack3_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack3_ffn_d_w1,N,"D*H,DF*H",1,stack3_ffn_d_x2,stack3_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack3_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack3_ffn_d_x1,stack3_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack3_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack3_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack4_mha_d_norm,N,"B/bp,Seq,H,D",1,stack4_ffn_d_x00,stack4_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack4_mha_d_res,N,"B/bp,Seq,H,D",1,stack4_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack4_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack4_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack4_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack4_mha_d_qkv,stack4_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack4_mha_d_v,N,"B/bp,Seq,H,D",1,stack4_mha_d_qkv,stack4_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack4_mha_d_k,N,"B/bp,Seq,H,D",1,stack4_mha_d_qk,stack4_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack4_mha_d_q,N,"B/bp,Seq,H,D",1,stack4_mha_d_qk,stack4_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack4_mha_d_wv,N,"H,D,D",1,stack4_mha_d_v,stack4_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack4_mha_d_wk,N,"H,D,D",1,stack4_mha_d_k,stack4_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack4_mha_d_wq,N,"H,D,D",1,stack4_mha_d_q,stack4_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack4_mha_d_x0,N,"B/bp,Seq,H,D",1,stack4_mha_d_v,stack4_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack4_mha_d_x1,N,"B/bp,Seq,H,D",1,stack4_mha_d_k,stack4_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack4_mha_d_x2,N,"B/bp,Seq,H,D",1,stack4_mha_d_q,stack4_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack4_mha_d_x3,N,"B/bp,Seq,H,D",1,stack4_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack4_mha_d_x01,N,"B/bp,Seq,H,D",1,stack4_mha_d_x0,stack4_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack4_mha_d_x23,N,"B/bp,Seq,H,D",1,stack4_mha_d_x2,stack4_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack4_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack5_mha_d_x01,stack5_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack4_ffn_d_res,N,"B/bp,Seq,D*H",1,stack4_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack4_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack4_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack4_ffn_d_w2,N,"DF*H,D*H",1,stack4_ffn_d_x2,stack4_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack4_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack4_ffn_d_x2,stack4_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack4_ffn_d_w1,N,"D*H,DF*H",1,stack4_ffn_d_x2,stack4_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack4_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack4_ffn_d_x1,stack4_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack4_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack4_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack5_mha_d_norm,N,"B/bp,Seq,H,D",1,stack5_ffn_d_x00,stack5_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack5_mha_d_res,N,"B/bp,Seq,H,D",1,stack5_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack5_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack5_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack5_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack5_mha_d_qkv,stack5_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack5_mha_d_v,N,"B/bp,Seq,H,D",1,stack5_mha_d_qkv,stack5_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack5_mha_d_k,N,"B/bp,Seq,H,D",1,stack5_mha_d_qk,stack5_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack5_mha_d_q,N,"B/bp,Seq,H,D",1,stack5_mha_d_qk,stack5_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack5_mha_d_wv,N,"H,D,D",1,stack5_mha_d_v,stack5_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack5_mha_d_wk,N,"H,D,D",1,stack5_mha_d_k,stack5_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack5_mha_d_wq,N,"H,D,D",1,stack5_mha_d_q,stack5_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack5_mha_d_x0,N,"B/bp,Seq,H,D",1,stack5_mha_d_v,stack5_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack5_mha_d_x1,N,"B/bp,Seq,H,D",1,stack5_mha_d_k,stack5_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack5_mha_d_x2,N,"B/bp,Seq,H,D",1,stack5_mha_d_q,stack5_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack5_mha_d_x3,N,"B/bp,Seq,H,D",1,stack5_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack5_mha_d_x01,N,"B/bp,Seq,H,D",1,stack5_mha_d_x0,stack5_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack5_mha_d_x23,N,"B/bp,Seq,H,D",1,stack5_mha_d_x2,stack5_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack5_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack6_mha_d_x01,stack6_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack5_ffn_d_res,N,"B/bp,Seq,D*H",1,stack5_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack5_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack5_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack5_ffn_d_w2,N,"DF*H,D*H",1,stack5_ffn_d_x2,stack5_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack5_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack5_ffn_d_x2,stack5_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack5_ffn_d_w1,N,"D*H,DF*H",1,stack5_ffn_d_x2,stack5_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack5_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack5_ffn_d_x1,stack5_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack5_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack5_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack6_mha_d_norm,N,"B/bp,Seq,H,D",1,stack6_ffn_d_x00,stack6_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack6_mha_d_res,N,"B/bp,Seq,H,D",1,stack6_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack6_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack6_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack6_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack6_mha_d_qkv,stack6_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack6_mha_d_v,N,"B/bp,Seq,H,D",1,stack6_mha_d_qkv,stack6_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack6_mha_d_k,N,"B/bp,Seq,H,D",1,stack6_mha_d_qk,stack6_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack6_mha_d_q,N,"B/bp,Seq,H,D",1,stack6_mha_d_qk,stack6_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack6_mha_d_wv,N,"H,D,D",1,stack6_mha_d_v,stack6_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack6_mha_d_wk,N,"H,D,D",1,stack6_mha_d_k,stack6_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack6_mha_d_wq,N,"H,D,D",1,stack6_mha_d_q,stack6_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack6_mha_d_x0,N,"B/bp,Seq,H,D",1,stack6_mha_d_v,stack6_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack6_mha_d_x1,N,"B/bp,Seq,H,D",1,stack6_mha_d_k,stack6_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack6_mha_d_x2,N,"B/bp,Seq,H,D",1,stack6_mha_d_q,stack6_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack6_mha_d_x3,N,"B/bp,Seq,H,D",1,stack6_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack6_mha_d_x01,N,"B/bp,Seq,H,D",1,stack6_mha_d_x0,stack6_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack6_mha_d_x23,N,"B/bp,Seq,H,D",1,stack6_mha_d_x2,stack6_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack6_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack7_mha_d_x01,stack7_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack6_ffn_d_res,N,"B/bp,Seq,D*H",1,stack6_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack6_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack6_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack6_ffn_d_w2,N,"DF*H,D*H",1,stack6_ffn_d_x2,stack6_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack6_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack6_ffn_d_x2,stack6_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack6_ffn_d_w1,N,"D*H,DF*H",1,stack6_ffn_d_x2,stack6_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack6_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack6_ffn_d_x1,stack6_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack6_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack6_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack7_mha_d_norm,N,"B/bp,Seq,H,D",1,stack7_ffn_d_x00,stack7_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack7_mha_d_res,N,"B/bp,Seq,H,D",1,stack7_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack7_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack7_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack7_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack7_mha_d_qkv,stack7_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack7_mha_d_v,N,"B/bp,Seq,H,D",1,stack7_mha_d_qkv,stack7_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack7_mha_d_k,N,"B/bp,Seq,H,D",1,stack7_mha_d_qk,stack7_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack7_mha_d_q,N,"B/bp,Seq,H,D",1,stack7_mha_d_qk,stack7_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack7_mha_d_wv,N,"H,D,D",1,stack7_mha_d_v,stack7_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack7_mha_d_wk,N,"H,D,D",1,stack7_mha_d_k,stack7_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack7_mha_d_wq,N,"H,D,D",1,stack7_mha_d_q,stack7_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack7_mha_d_x0,N,"B/bp,Seq,H,D",1,stack7_mha_d_v,stack7_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack7_mha_d_x1,N,"B/bp,Seq,H,D",1,stack7_mha_d_k,stack7_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack7_mha_d_x2,N,"B/bp,Seq,H,D",1,stack7_mha_d_q,stack7_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack7_mha_d_x3,N,"B/bp,Seq,H,D",1,stack7_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack7_mha_d_x01,N,"B/bp,Seq,H,D",1,stack7_mha_d_x0,stack7_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack7_mha_d_x23,N,"B/bp,Seq,H,D",1,stack7_mha_d_x2,stack7_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack7_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack8_mha_d_x01,stack8_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack7_ffn_d_res,N,"B/bp,Seq,D*H",1,stack7_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack7_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack7_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack7_ffn_d_w2,N,"DF*H,D*H",1,stack7_ffn_d_x2,stack7_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack7_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack7_ffn_d_x2,stack7_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack7_ffn_d_w1,N,"D*H,DF*H",1,stack7_ffn_d_x2,stack7_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack7_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack7_ffn_d_x1,stack7_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack7_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack7_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack8_mha_d_norm,N,"B/bp,Seq,H,D",1,stack8_ffn_d_x00,stack8_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack8_mha_d_res,N,"B/bp,Seq,H,D",1,stack8_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack8_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack8_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack8_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack8_mha_d_qkv,stack8_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack8_mha_d_v,N,"B/bp,Seq,H,D",1,stack8_mha_d_qkv,stack8_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack8_mha_d_k,N,"B/bp,Seq,H,D",1,stack8_mha_d_qk,stack8_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack8_mha_d_q,N,"B/bp,Seq,H,D",1,stack8_mha_d_qk,stack8_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack8_mha_d_wv,N,"H,D,D",1,stack8_mha_d_v,stack8_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack8_mha_d_wk,N,"H,D,D",1,stack8_mha_d_k,stack8_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack8_mha_d_wq,N,"H,D,D",1,stack8_mha_d_q,stack8_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack8_mha_d_x0,N,"B/bp,Seq,H,D",1,stack8_mha_d_v,stack8_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack8_mha_d_x1,N,"B/bp,Seq,H,D",1,stack8_mha_d_k,stack8_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack8_mha_d_x2,N,"B/bp,Seq,H,D",1,stack8_mha_d_q,stack8_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack8_mha_d_x3,N,"B/bp,Seq,H,D",1,stack8_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack8_mha_d_x01,N,"B/bp,Seq,H,D",1,stack8_mha_d_x0,stack8_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack8_mha_d_x23,N,"B/bp,Seq,H,D",1,stack8_mha_d_x2,stack8_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack8_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack9_mha_d_x01,stack9_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack8_ffn_d_res,N,"B/bp,Seq,D*H",1,stack8_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack8_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack8_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack8_ffn_d_w2,N,"DF*H,D*H",1,stack8_ffn_d_x2,stack8_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack8_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack8_ffn_d_x2,stack8_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack8_ffn_d_w1,N,"D*H,DF*H",1,stack8_ffn_d_x2,stack8_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack8_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack8_ffn_d_x1,stack8_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack8_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack8_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack9_mha_d_norm,N,"B/bp,Seq,H,D",1,stack9_ffn_d_x00,stack9_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack9_mha_d_res,N,"B/bp,Seq,H,D",1,stack9_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack9_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack9_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack9_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack9_mha_d_qkv,stack9_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack9_mha_d_v,N,"B/bp,Seq,H,D",1,stack9_mha_d_qkv,stack9_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack9_mha_d_k,N,"B/bp,Seq,H,D",1,stack9_mha_d_qk,stack9_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack9_mha_d_q,N,"B/bp,Seq,H,D",1,stack9_mha_d_qk,stack9_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack9_mha_d_wv,N,"H,D,D",1,stack9_mha_d_v,stack9_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack9_mha_d_wk,N,"H,D,D",1,stack9_mha_d_k,stack9_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack9_mha_d_wq,N,"H,D,D",1,stack9_mha_d_q,stack9_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack9_mha_d_x0,N,"B/bp,Seq,H,D",1,stack9_mha_d_v,stack9_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack9_mha_d_x1,N,"B/bp,Seq,H,D",1,stack9_mha_d_k,stack9_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack9_mha_d_x2,N,"B/bp,Seq,H,D",1,stack9_mha_d_q,stack9_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack9_mha_d_x3,N,"B/bp,Seq,H,D",1,stack9_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack9_mha_d_x01,N,"B/bp,Seq,H,D",1,stack9_mha_d_x0,stack9_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack9_mha_d_x23,N,"B/bp,Seq,H,D",1,stack9_mha_d_x2,stack9_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack9_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack10_mha_d_x01,stack10_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack9_ffn_d_res,N,"B/bp,Seq,D*H",1,stack9_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack9_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack9_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack9_ffn_d_w2,N,"DF*H,D*H",1,stack9_ffn_d_x2,stack9_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack9_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack9_ffn_d_x2,stack9_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack9_ffn_d_w1,N,"D*H,DF*H",1,stack9_ffn_d_x2,stack9_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack9_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack9_ffn_d_x1,stack9_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack9_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack9_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack10_mha_d_norm,N,"B/bp,Seq,H,D",1,stack10_ffn_d_x00,stack10_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack10_mha_d_res,N,"B/bp,Seq,H,D",1,stack10_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack10_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack10_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack10_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack10_mha_d_qkv,stack10_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack10_mha_d_v,N,"B/bp,Seq,H,D",1,stack10_mha_d_qkv,stack10_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack10_mha_d_k,N,"B/bp,Seq,H,D",1,stack10_mha_d_qk,stack10_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack10_mha_d_q,N,"B/bp,Seq,H,D",1,stack10_mha_d_qk,stack10_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack10_mha_d_wv,N,"H,D,D",1,stack10_mha_d_v,stack10_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack10_mha_d_wk,N,"H,D,D",1,stack10_mha_d_k,stack10_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack10_mha_d_wq,N,"H,D,D",1,stack10_mha_d_q,stack10_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack10_mha_d_x0,N,"B/bp,Seq,H,D",1,stack10_mha_d_v,stack10_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack10_mha_d_x1,N,"B/bp,Seq,H,D",1,stack10_mha_d_k,stack10_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack10_mha_d_x2,N,"B/bp,Seq,H,D",1,stack10_mha_d_q,stack10_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack10_mha_d_x3,N,"B/bp,Seq,H,D",1,stack10_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack10_mha_d_x01,N,"B/bp,Seq,H,D",1,stack10_mha_d_x0,stack10_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack10_mha_d_x23,N,"B/bp,Seq,H,D",1,stack10_mha_d_x2,stack10_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack10_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack11_mha_d_x01,stack11_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack10_ffn_d_res,N,"B/bp,Seq,D*H",1,stack10_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack10_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack10_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack10_ffn_d_w2,N,"DF*H,D*H",1,stack10_ffn_d_x2,stack10_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack10_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack10_ffn_d_x2,stack10_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack10_ffn_d_w1,N,"D*H,DF*H",1,stack10_ffn_d_x2,stack10_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack10_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack10_ffn_d_x1,stack10_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack10_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack10_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack11_mha_d_norm,N,"B/bp,Seq,H,D",1,stack11_ffn_d_x00,stack11_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack11_mha_d_res,N,"B/bp,Seq,H,D",1,stack11_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack11_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack11_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack11_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack11_mha_d_qkv,stack11_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack11_mha_d_v,N,"B/bp,Seq,H,D",1,stack11_mha_d_qkv,stack11_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack11_mha_d_k,N,"B/bp,Seq,H,D",1,stack11_mha_d_qk,stack11_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack11_mha_d_q,N,"B/bp,Seq,H,D",1,stack11_mha_d_qk,stack11_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack11_mha_d_wv,N,"H,D,D",1,stack11_mha_d_v,stack11_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack11_mha_d_wk,N,"H,D,D",1,stack11_mha_d_k,stack11_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack11_mha_d_wq,N,"H,D,D",1,stack11_mha_d_q,stack11_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack11_mha_d_x0,N,"B/bp,Seq,H,D",1,stack11_mha_d_v,stack11_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack11_mha_d_x1,N,"B/bp,Seq,H,D",1,stack11_mha_d_k,stack11_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack11_mha_d_x2,N,"B/bp,Seq,H,D",1,stack11_mha_d_q,stack11_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack11_mha_d_x3,N,"B/bp,Seq,H,D",1,stack11_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack11_mha_d_x01,N,"B/bp,Seq,H,D",1,stack11_mha_d_x0,stack11_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack11_mha_d_x23,N,"B/bp,Seq,H,D",1,stack11_mha_d_x2,stack11_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack11_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack12_mha_d_x01,stack12_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack11_ffn_d_res,N,"B/bp,Seq,D*H",1,stack11_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack11_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack11_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack11_ffn_d_w2,N,"DF*H,D*H",1,stack11_ffn_d_x2,stack11_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack11_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack11_ffn_d_x2,stack11_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack11_ffn_d_w1,N,"D*H,DF*H",1,stack11_ffn_d_x2,stack11_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack11_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack11_ffn_d_x1,stack11_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack11_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack11_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack12_mha_d_norm,N,"B/bp,Seq,H,D",1,stack12_ffn_d_x00,stack12_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack12_mha_d_res,N,"B/bp,Seq,H,D",1,stack12_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack12_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack12_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack12_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack12_mha_d_qkv,stack12_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack12_mha_d_v,N,"B/bp,Seq,H,D",1,stack12_mha_d_qkv,stack12_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack12_mha_d_k,N,"B/bp,Seq,H,D",1,stack12_mha_d_qk,stack12_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack12_mha_d_q,N,"B/bp,Seq,H,D",1,stack12_mha_d_qk,stack12_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack12_mha_d_wv,N,"H,D,D",1,stack12_mha_d_v,stack12_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack12_mha_d_wk,N,"H,D,D",1,stack12_mha_d_k,stack12_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack12_mha_d_wq,N,"H,D,D",1,stack12_mha_d_q,stack12_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack12_mha_d_x0,N,"B/bp,Seq,H,D",1,stack12_mha_d_v,stack12_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack12_mha_d_x1,N,"B/bp,Seq,H,D",1,stack12_mha_d_k,stack12_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack12_mha_d_x2,N,"B/bp,Seq,H,D",1,stack12_mha_d_q,stack12_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack12_mha_d_x3,N,"B/bp,Seq,H,D",1,stack12_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack12_mha_d_x01,N,"B/bp,Seq,H,D",1,stack12_mha_d_x0,stack12_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack12_mha_d_x23,N,"B/bp,Seq,H,D",1,stack12_mha_d_x2,stack12_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack12_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack13_mha_d_x01,stack13_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack12_ffn_d_res,N,"B/bp,Seq,D*H",1,stack12_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack12_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack12_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack12_ffn_d_w2,N,"DF*H,D*H",1,stack12_ffn_d_x2,stack12_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack12_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack12_ffn_d_x2,stack12_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack12_ffn_d_w1,N,"D*H,DF*H",1,stack12_ffn_d_x2,stack12_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack12_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack12_ffn_d_x1,stack12_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack12_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack12_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack13_mha_d_norm,N,"B/bp,Seq,H,D",1,stack13_ffn_d_x00,stack13_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack13_mha_d_res,N,"B/bp,Seq,H,D",1,stack13_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack13_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack13_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack13_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack13_mha_d_qkv,stack13_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack13_mha_d_v,N,"B/bp,Seq,H,D",1,stack13_mha_d_qkv,stack13_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack13_mha_d_k,N,"B/bp,Seq,H,D",1,stack13_mha_d_qk,stack13_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack13_mha_d_q,N,"B/bp,Seq,H,D",1,stack13_mha_d_qk,stack13_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack13_mha_d_wv,N,"H,D,D",1,stack13_mha_d_v,stack13_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack13_mha_d_wk,N,"H,D,D",1,stack13_mha_d_k,stack13_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack13_mha_d_wq,N,"H,D,D",1,stack13_mha_d_q,stack13_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack13_mha_d_x0,N,"B/bp,Seq,H,D",1,stack13_mha_d_v,stack13_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack13_mha_d_x1,N,"B/bp,Seq,H,D",1,stack13_mha_d_k,stack13_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack13_mha_d_x2,N,"B/bp,Seq,H,D",1,stack13_mha_d_q,stack13_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack13_mha_d_x3,N,"B/bp,Seq,H,D",1,stack13_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack13_mha_d_x01,N,"B/bp,Seq,H,D",1,stack13_mha_d_x0,stack13_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack13_mha_d_x23,N,"B/bp,Seq,H,D",1,stack13_mha_d_x2,stack13_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack13_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack14_mha_d_x01,stack14_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack13_ffn_d_res,N,"B/bp,Seq,D*H",1,stack13_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack13_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack13_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack13_ffn_d_w2,N,"DF*H,D*H",1,stack13_ffn_d_x2,stack13_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack13_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack13_ffn_d_x2,stack13_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack13_ffn_d_w1,N,"D*H,DF*H",1,stack13_ffn_d_x2,stack13_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack13_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack13_ffn_d_x1,stack13_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack13_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack13_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack14_mha_d_norm,N,"B/bp,Seq,H,D",1,stack14_ffn_d_x00,stack14_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack14_mha_d_res,N,"B/bp,Seq,H,D",1,stack14_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack14_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack14_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack14_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack14_mha_d_qkv,stack14_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack14_mha_d_v,N,"B/bp,Seq,H,D",1,stack14_mha_d_qkv,stack14_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack14_mha_d_k,N,"B/bp,Seq,H,D",1,stack14_mha_d_qk,stack14_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack14_mha_d_q,N,"B/bp,Seq,H,D",1,stack14_mha_d_qk,stack14_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack14_mha_d_wv,N,"H,D,D",1,stack14_mha_d_v,stack14_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack14_mha_d_wk,N,"H,D,D",1,stack14_mha_d_k,stack14_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack14_mha_d_wq,N,"H,D,D",1,stack14_mha_d_q,stack14_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack14_mha_d_x0,N,"B/bp,Seq,H,D",1,stack14_mha_d_v,stack14_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack14_mha_d_x1,N,"B/bp,Seq,H,D",1,stack14_mha_d_k,stack14_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack14_mha_d_x2,N,"B/bp,Seq,H,D",1,stack14_mha_d_q,stack14_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack14_mha_d_x3,N,"B/bp,Seq,H,D",1,stack14_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack14_mha_d_x01,N,"B/bp,Seq,H,D",1,stack14_mha_d_x0,stack14_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack14_mha_d_x23,N,"B/bp,Seq,H,D",1,stack14_mha_d_x2,stack14_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack14_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack15_mha_d_x01,stack15_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack14_ffn_d_res,N,"B/bp,Seq,D*H",1,stack14_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack14_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack14_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack14_ffn_d_w2,N,"DF*H,D*H",1,stack14_ffn_d_x2,stack14_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack14_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack14_ffn_d_x2,stack14_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack14_ffn_d_w1,N,"D*H,DF*H",1,stack14_ffn_d_x2,stack14_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack14_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack14_ffn_d_x1,stack14_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack14_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack14_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack15_mha_d_norm,N,"B/bp,Seq,H,D",1,stack15_ffn_d_x00,stack15_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack15_mha_d_res,N,"B/bp,Seq,H,D",1,stack15_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack15_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack15_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack15_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack15_mha_d_qkv,stack15_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack15_mha_d_v,N,"B/bp,Seq,H,D",1,stack15_mha_d_qkv,stack15_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack15_mha_d_k,N,"B/bp,Seq,H,D",1,stack15_mha_d_qk,stack15_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack15_mha_d_q,N,"B/bp,Seq,H,D",1,stack15_mha_d_qk,stack15_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack15_mha_d_wv,N,"H,D,D",1,stack15_mha_d_v,stack15_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack15_mha_d_wk,N,"H,D,D",1,stack15_mha_d_k,stack15_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack15_mha_d_wq,N,"H,D,D",1,stack15_mha_d_q,stack15_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack15_mha_d_x0,N,"B/bp,Seq,H,D",1,stack15_mha_d_v,stack15_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack15_mha_d_x1,N,"B/bp,Seq,H,D",1,stack15_mha_d_k,stack15_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack15_mha_d_x2,N,"B/bp,Seq,H,D",1,stack15_mha_d_q,stack15_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack15_mha_d_x3,N,"B/bp,Seq,H,D",1,stack15_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack15_mha_d_x01,N,"B/bp,Seq,H,D",1,stack15_mha_d_x0,stack15_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack15_mha_d_x23,N,"B/bp,Seq,H,D",1,stack15_mha_d_x2,stack15_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack15_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack16_mha_d_x01,stack16_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack15_ffn_d_res,N,"B/bp,Seq,D*H",1,stack15_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack15_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack15_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack15_ffn_d_w2,N,"DF*H,D*H",1,stack15_ffn_d_x2,stack15_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack15_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack15_ffn_d_x2,stack15_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack15_ffn_d_w1,N,"D*H,DF*H",1,stack15_ffn_d_x2,stack15_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack15_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack15_ffn_d_x1,stack15_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack15_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack15_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack16_mha_d_norm,N,"B/bp,Seq,H,D",1,stack16_ffn_d_x00,stack16_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack16_mha_d_res,N,"B/bp,Seq,H,D",1,stack16_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack16_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack16_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack16_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack16_mha_d_qkv,stack16_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack16_mha_d_v,N,"B/bp,Seq,H,D",1,stack16_mha_d_qkv,stack16_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack16_mha_d_k,N,"B/bp,Seq,H,D",1,stack16_mha_d_qk,stack16_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack16_mha_d_q,N,"B/bp,Seq,H,D",1,stack16_mha_d_qk,stack16_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack16_mha_d_wv,N,"H,D,D",1,stack16_mha_d_v,stack16_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack16_mha_d_wk,N,"H,D,D",1,stack16_mha_d_k,stack16_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack16_mha_d_wq,N,"H,D,D",1,stack16_mha_d_q,stack16_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack16_mha_d_x0,N,"B/bp,Seq,H,D",1,stack16_mha_d_v,stack16_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack16_mha_d_x1,N,"B/bp,Seq,H,D",1,stack16_mha_d_k,stack16_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack16_mha_d_x2,N,"B/bp,Seq,H,D",1,stack16_mha_d_q,stack16_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack16_mha_d_x3,N,"B/bp,Seq,H,D",1,stack16_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack16_mha_d_x01,N,"B/bp,Seq,H,D",1,stack16_mha_d_x0,stack16_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack16_mha_d_x23,N,"B/bp,Seq,H,D",1,stack16_mha_d_x2,stack16_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack16_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack17_mha_d_x01,stack17_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack16_ffn_d_res,N,"B/bp,Seq,D*H",1,stack16_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack16_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack16_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack16_ffn_d_w2,N,"DF*H,D*H",1,stack16_ffn_d_x2,stack16_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack16_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack16_ffn_d_x2,stack16_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack16_ffn_d_w1,N,"D*H,DF*H",1,stack16_ffn_d_x2,stack16_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack16_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack16_ffn_d_x1,stack16_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack16_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack16_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack17_mha_d_norm,N,"B/bp,Seq,H,D",1,stack17_ffn_d_x00,stack17_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack17_mha_d_res,N,"B/bp,Seq,H,D",1,stack17_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack17_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack17_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack17_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack17_mha_d_qkv,stack17_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack17_mha_d_v,N,"B/bp,Seq,H,D",1,stack17_mha_d_qkv,stack17_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack17_mha_d_k,N,"B/bp,Seq,H,D",1,stack17_mha_d_qk,stack17_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack17_mha_d_q,N,"B/bp,Seq,H,D",1,stack17_mha_d_qk,stack17_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack17_mha_d_wv,N,"H,D,D",1,stack17_mha_d_v,stack17_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack17_mha_d_wk,N,"H,D,D",1,stack17_mha_d_k,stack17_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack17_mha_d_wq,N,"H,D,D",1,stack17_mha_d_q,stack17_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack17_mha_d_x0,N,"B/bp,Seq,H,D",1,stack17_mha_d_v,stack17_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack17_mha_d_x1,N,"B/bp,Seq,H,D",1,stack17_mha_d_k,stack17_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack17_mha_d_x2,N,"B/bp,Seq,H,D",1,stack17_mha_d_q,stack17_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack17_mha_d_x3,N,"B/bp,Seq,H,D",1,stack17_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack17_mha_d_x01,N,"B/bp,Seq,H,D",1,stack17_mha_d_x0,stack17_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack17_mha_d_x23,N,"B/bp,Seq,H,D",1,stack17_mha_d_x2,stack17_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack17_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack18_mha_d_x01,stack18_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack17_ffn_d_res,N,"B/bp,Seq,D*H",1,stack17_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack17_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack17_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack17_ffn_d_w2,N,"DF*H,D*H",1,stack17_ffn_d_x2,stack17_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack17_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack17_ffn_d_x2,stack17_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack17_ffn_d_w1,N,"D*H,DF*H",1,stack17_ffn_d_x2,stack17_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack17_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack17_ffn_d_x1,stack17_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack17_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack17_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack18_mha_d_norm,N,"B/bp,Seq,H,D",1,stack18_ffn_d_x00,stack18_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack18_mha_d_res,N,"B/bp,Seq,H,D",1,stack18_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack18_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack18_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack18_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack18_mha_d_qkv,stack18_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack18_mha_d_v,N,"B/bp,Seq,H,D",1,stack18_mha_d_qkv,stack18_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack18_mha_d_k,N,"B/bp,Seq,H,D",1,stack18_mha_d_qk,stack18_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack18_mha_d_q,N,"B/bp,Seq,H,D",1,stack18_mha_d_qk,stack18_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack18_mha_d_wv,N,"H,D,D",1,stack18_mha_d_v,stack18_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack18_mha_d_wk,N,"H,D,D",1,stack18_mha_d_k,stack18_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack18_mha_d_wq,N,"H,D,D",1,stack18_mha_d_q,stack18_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack18_mha_d_x0,N,"B/bp,Seq,H,D",1,stack18_mha_d_v,stack18_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack18_mha_d_x1,N,"B/bp,Seq,H,D",1,stack18_mha_d_k,stack18_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack18_mha_d_x2,N,"B/bp,Seq,H,D",1,stack18_mha_d_q,stack18_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack18_mha_d_x3,N,"B/bp,Seq,H,D",1,stack18_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack18_mha_d_x01,N,"B/bp,Seq,H,D",1,stack18_mha_d_x0,stack18_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack18_mha_d_x23,N,"B/bp,Seq,H,D",1,stack18_mha_d_x2,stack18_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack18_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack19_mha_d_x01,stack19_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack18_ffn_d_res,N,"B/bp,Seq,D*H",1,stack18_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack18_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack18_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack18_ffn_d_w2,N,"DF*H,D*H",1,stack18_ffn_d_x2,stack18_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack18_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack18_ffn_d_x2,stack18_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack18_ffn_d_w1,N,"D*H,DF*H",1,stack18_ffn_d_x2,stack18_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack18_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack18_ffn_d_x1,stack18_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack18_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack18_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack19_mha_d_norm,N,"B/bp,Seq,H,D",1,stack19_ffn_d_x00,stack19_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack19_mha_d_res,N,"B/bp,Seq,H,D",1,stack19_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack19_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack19_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack19_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack19_mha_d_qkv,stack19_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack19_mha_d_v,N,"B/bp,Seq,H,D",1,stack19_mha_d_qkv,stack19_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack19_mha_d_k,N,"B/bp,Seq,H,D",1,stack19_mha_d_qk,stack19_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack19_mha_d_q,N,"B/bp,Seq,H,D",1,stack19_mha_d_qk,stack19_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack19_mha_d_wv,N,"H,D,D",1,stack19_mha_d_v,stack19_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack19_mha_d_wk,N,"H,D,D",1,stack19_mha_d_k,stack19_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack19_mha_d_wq,N,"H,D,D",1,stack19_mha_d_q,stack19_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack19_mha_d_x0,N,"B/bp,Seq,H,D",1,stack19_mha_d_v,stack19_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack19_mha_d_x1,N,"B/bp,Seq,H,D",1,stack19_mha_d_k,stack19_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack19_mha_d_x2,N,"B/bp,Seq,H,D",1,stack19_mha_d_q,stack19_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack19_mha_d_x3,N,"B/bp,Seq,H,D",1,stack19_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack19_mha_d_x01,N,"B/bp,Seq,H,D",1,stack19_mha_d_x0,stack19_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack19_mha_d_x23,N,"B/bp,Seq,H,D",1,stack19_mha_d_x2,stack19_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack19_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack20_mha_d_x01,stack20_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack19_ffn_d_res,N,"B/bp,Seq,D*H",1,stack19_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack19_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack19_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack19_ffn_d_w2,N,"DF*H,D*H",1,stack19_ffn_d_x2,stack19_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack19_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack19_ffn_d_x2,stack19_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack19_ffn_d_w1,N,"D*H,DF*H",1,stack19_ffn_d_x2,stack19_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack19_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack19_ffn_d_x1,stack19_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack19_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack19_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack20_mha_d_norm,N,"B/bp,Seq,H,D",1,stack20_ffn_d_x00,stack20_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack20_mha_d_res,N,"B/bp,Seq,H,D",1,stack20_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack20_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack20_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack20_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack20_mha_d_qkv,stack20_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack20_mha_d_v,N,"B/bp,Seq,H,D",1,stack20_mha_d_qkv,stack20_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack20_mha_d_k,N,"B/bp,Seq,H,D",1,stack20_mha_d_qk,stack20_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack20_mha_d_q,N,"B/bp,Seq,H,D",1,stack20_mha_d_qk,stack20_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack20_mha_d_wv,N,"H,D,D",1,stack20_mha_d_v,stack20_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack20_mha_d_wk,N,"H,D,D",1,stack20_mha_d_k,stack20_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack20_mha_d_wq,N,"H,D,D",1,stack20_mha_d_q,stack20_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack20_mha_d_x0,N,"B/bp,Seq,H,D",1,stack20_mha_d_v,stack20_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack20_mha_d_x1,N,"B/bp,Seq,H,D",1,stack20_mha_d_k,stack20_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack20_mha_d_x2,N,"B/bp,Seq,H,D",1,stack20_mha_d_q,stack20_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack20_mha_d_x3,N,"B/bp,Seq,H,D",1,stack20_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack20_mha_d_x01,N,"B/bp,Seq,H,D",1,stack20_mha_d_x0,stack20_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack20_mha_d_x23,N,"B/bp,Seq,H,D",1,stack20_mha_d_x2,stack20_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack20_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack21_mha_d_x01,stack21_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack20_ffn_d_res,N,"B/bp,Seq,D*H",1,stack20_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack20_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack20_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack20_ffn_d_w2,N,"DF*H,D*H",1,stack20_ffn_d_x2,stack20_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack20_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack20_ffn_d_x2,stack20_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack20_ffn_d_w1,N,"D*H,DF*H",1,stack20_ffn_d_x2,stack20_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack20_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack20_ffn_d_x1,stack20_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack20_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack20_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack21_mha_d_norm,N,"B/bp,Seq,H,D",1,stack21_ffn_d_x00,stack21_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack21_mha_d_res,N,"B/bp,Seq,H,D",1,stack21_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack21_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack21_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack21_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack21_mha_d_qkv,stack21_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack21_mha_d_v,N,"B/bp,Seq,H,D",1,stack21_mha_d_qkv,stack21_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack21_mha_d_k,N,"B/bp,Seq,H,D",1,stack21_mha_d_qk,stack21_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack21_mha_d_q,N,"B/bp,Seq,H,D",1,stack21_mha_d_qk,stack21_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack21_mha_d_wv,N,"H,D,D",1,stack21_mha_d_v,stack21_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack21_mha_d_wk,N,"H,D,D",1,stack21_mha_d_k,stack21_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack21_mha_d_wq,N,"H,D,D",1,stack21_mha_d_q,stack21_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack21_mha_d_x0,N,"B/bp,Seq,H,D",1,stack21_mha_d_v,stack21_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack21_mha_d_x1,N,"B/bp,Seq,H,D",1,stack21_mha_d_k,stack21_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack21_mha_d_x2,N,"B/bp,Seq,H,D",1,stack21_mha_d_q,stack21_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack21_mha_d_x3,N,"B/bp,Seq,H,D",1,stack21_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack21_mha_d_x01,N,"B/bp,Seq,H,D",1,stack21_mha_d_x0,stack21_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack21_mha_d_x23,N,"B/bp,Seq,H,D",1,stack21_mha_d_x2,stack21_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack21_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack22_mha_d_x01,stack22_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack21_ffn_d_res,N,"B/bp,Seq,D*H",1,stack21_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack21_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack21_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack21_ffn_d_w2,N,"DF*H,D*H",1,stack21_ffn_d_x2,stack21_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack21_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack21_ffn_d_x2,stack21_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack21_ffn_d_w1,N,"D*H,DF*H",1,stack21_ffn_d_x2,stack21_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack21_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack21_ffn_d_x1,stack21_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack21_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack21_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack22_mha_d_norm,N,"B/bp,Seq,H,D",1,stack22_ffn_d_x00,stack22_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack22_mha_d_res,N,"B/bp,Seq,H,D",1,stack22_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack22_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack22_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack22_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack22_mha_d_qkv,stack22_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack22_mha_d_v,N,"B/bp,Seq,H,D",1,stack22_mha_d_qkv,stack22_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack22_mha_d_k,N,"B/bp,Seq,H,D",1,stack22_mha_d_qk,stack22_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack22_mha_d_q,N,"B/bp,Seq,H,D",1,stack22_mha_d_qk,stack22_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack22_mha_d_wv,N,"H,D,D",1,stack22_mha_d_v,stack22_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack22_mha_d_wk,N,"H,D,D",1,stack22_mha_d_k,stack22_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack22_mha_d_wq,N,"H,D,D",1,stack22_mha_d_q,stack22_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack22_mha_d_x0,N,"B/bp,Seq,H,D",1,stack22_mha_d_v,stack22_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack22_mha_d_x1,N,"B/bp,Seq,H,D",1,stack22_mha_d_k,stack22_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack22_mha_d_x2,N,"B/bp,Seq,H,D",1,stack22_mha_d_q,stack22_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack22_mha_d_x3,N,"B/bp,Seq,H,D",1,stack22_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack22_mha_d_x01,N,"B/bp,Seq,H,D",1,stack22_mha_d_x0,stack22_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack22_mha_d_x23,N,"B/bp,Seq,H,D",1,stack22_mha_d_x2,stack22_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack22_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack23_mha_d_x01,stack23_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack22_ffn_d_res,N,"B/bp,Seq,D*H",1,stack22_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack22_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack22_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack22_ffn_d_w2,N,"DF*H,D*H",1,stack22_ffn_d_x2,stack22_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack22_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack22_ffn_d_x2,stack22_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack22_ffn_d_w1,N,"D*H,DF*H",1,stack22_ffn_d_x2,stack22_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack22_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack22_ffn_d_x1,stack22_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack22_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack22_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack23_mha_d_norm,N,"B/bp,Seq,H,D",1,stack23_ffn_d_x00,stack23_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack23_mha_d_res,N,"B/bp,Seq,H,D",1,stack23_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack23_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack23_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack23_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack23_mha_d_qkv,stack23_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack23_mha_d_v,N,"B/bp,Seq,H,D",1,stack23_mha_d_qkv,stack23_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack23_mha_d_k,N,"B/bp,Seq,H,D",1,stack23_mha_d_qk,stack23_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack23_mha_d_q,N,"B/bp,Seq,H,D",1,stack23_mha_d_qk,stack23_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack23_mha_d_wv,N,"H,D,D",1,stack23_mha_d_v,stack23_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack23_mha_d_wk,N,"H,D,D",1,stack23_mha_d_k,stack23_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack23_mha_d_wq,N,"H,D,D",1,stack23_mha_d_q,stack23_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack23_mha_d_x0,N,"B/bp,Seq,H,D",1,stack23_mha_d_v,stack23_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack23_mha_d_x1,N,"B/bp,Seq,H,D",1,stack23_mha_d_k,stack23_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack23_mha_d_x2,N,"B/bp,Seq,H,D",1,stack23_mha_d_q,stack23_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack23_mha_d_x3,N,"B/bp,Seq,H,D",1,stack23_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack23_mha_d_x01,N,"B/bp,Seq,H,D",1,stack23_mha_d_x0,stack23_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack23_mha_d_x23,N,"B/bp,Seq,H,D",1,stack23_mha_d_x2,stack23_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack23_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack24_mha_d_x01,stack24_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack23_ffn_d_res,N,"B/bp,Seq,D*H",1,stack23_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack23_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack23_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack23_ffn_d_w2,N,"DF*H,D*H",1,stack23_ffn_d_x2,stack23_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack23_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack23_ffn_d_x2,stack23_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack23_ffn_d_w1,N,"D*H,DF*H",1,stack23_ffn_d_x2,stack23_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack23_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack23_ffn_d_x1,stack23_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack23_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack23_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack24_mha_d_norm,N,"B/bp,Seq,H,D",1,stack24_ffn_d_x00,stack24_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack24_mha_d_res,N,"B/bp,Seq,H,D",1,stack24_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack24_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack24_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack24_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack24_mha_d_qkv,stack24_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack24_mha_d_v,N,"B/bp,Seq,H,D",1,stack24_mha_d_qkv,stack24_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack24_mha_d_k,N,"B/bp,Seq,H,D",1,stack24_mha_d_qk,stack24_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack24_mha_d_q,N,"B/bp,Seq,H,D",1,stack24_mha_d_qk,stack24_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack24_mha_d_wv,N,"H,D,D",1,stack24_mha_d_v,stack24_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack24_mha_d_wk,N,"H,D,D",1,stack24_mha_d_k,stack24_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack24_mha_d_wq,N,"H,D,D",1,stack24_mha_d_q,stack24_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack24_mha_d_x0,N,"B/bp,Seq,H,D",1,stack24_mha_d_v,stack24_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack24_mha_d_x1,N,"B/bp,Seq,H,D",1,stack24_mha_d_k,stack24_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack24_mha_d_x2,N,"B/bp,Seq,H,D",1,stack24_mha_d_q,stack24_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack24_mha_d_x3,N,"B/bp,Seq,H,D",1,stack24_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack24_mha_d_x01,N,"B/bp,Seq,H,D",1,stack24_mha_d_x0,stack24_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack24_mha_d_x23,N,"B/bp,Seq,H,D",1,stack24_mha_d_x2,stack24_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack24_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack25_mha_d_x01,stack25_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack24_ffn_d_res,N,"B/bp,Seq,D*H",1,stack24_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack24_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack24_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack24_ffn_d_w2,N,"DF*H,D*H",1,stack24_ffn_d_x2,stack24_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack24_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack24_ffn_d_x2,stack24_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack24_ffn_d_w1,N,"D*H,DF*H",1,stack24_ffn_d_x2,stack24_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack24_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack24_ffn_d_x1,stack24_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack24_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack24_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack25_mha_d_norm,N,"B/bp,Seq,H,D",1,stack25_ffn_d_x00,stack25_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack25_mha_d_res,N,"B/bp,Seq,H,D",1,stack25_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack25_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack25_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack25_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack25_mha_d_qkv,stack25_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack25_mha_d_v,N,"B/bp,Seq,H,D",1,stack25_mha_d_qkv,stack25_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack25_mha_d_k,N,"B/bp,Seq,H,D",1,stack25_mha_d_qk,stack25_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack25_mha_d_q,N,"B/bp,Seq,H,D",1,stack25_mha_d_qk,stack25_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack25_mha_d_wv,N,"H,D,D",1,stack25_mha_d_v,stack25_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack25_mha_d_wk,N,"H,D,D",1,stack25_mha_d_k,stack25_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack25_mha_d_wq,N,"H,D,D",1,stack25_mha_d_q,stack25_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack25_mha_d_x0,N,"B/bp,Seq,H,D",1,stack25_mha_d_v,stack25_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack25_mha_d_x1,N,"B/bp,Seq,H,D",1,stack25_mha_d_k,stack25_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack25_mha_d_x2,N,"B/bp,Seq,H,D",1,stack25_mha_d_q,stack25_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack25_mha_d_x3,N,"B/bp,Seq,H,D",1,stack25_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack25_mha_d_x01,N,"B/bp,Seq,H,D",1,stack25_mha_d_x0,stack25_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack25_mha_d_x23,N,"B/bp,Seq,H,D",1,stack25_mha_d_x2,stack25_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack25_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack26_mha_d_x01,stack26_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack25_ffn_d_res,N,"B/bp,Seq,D*H",1,stack25_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack25_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack25_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack25_ffn_d_w2,N,"DF*H,D*H",1,stack25_ffn_d_x2,stack25_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack25_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack25_ffn_d_x2,stack25_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack25_ffn_d_w1,N,"D*H,DF*H",1,stack25_ffn_d_x2,stack25_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack25_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack25_ffn_d_x1,stack25_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack25_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack25_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack26_mha_d_norm,N,"B/bp,Seq,H,D",1,stack26_ffn_d_x00,stack26_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack26_mha_d_res,N,"B/bp,Seq,H,D",1,stack26_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack26_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack26_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack26_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack26_mha_d_qkv,stack26_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack26_mha_d_v,N,"B/bp,Seq,H,D",1,stack26_mha_d_qkv,stack26_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack26_mha_d_k,N,"B/bp,Seq,H,D",1,stack26_mha_d_qk,stack26_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack26_mha_d_q,N,"B/bp,Seq,H,D",1,stack26_mha_d_qk,stack26_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack26_mha_d_wv,N,"H,D,D",1,stack26_mha_d_v,stack26_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack26_mha_d_wk,N,"H,D,D",1,stack26_mha_d_k,stack26_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack26_mha_d_wq,N,"H,D,D",1,stack26_mha_d_q,stack26_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack26_mha_d_x0,N,"B/bp,Seq,H,D",1,stack26_mha_d_v,stack26_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack26_mha_d_x1,N,"B/bp,Seq,H,D",1,stack26_mha_d_k,stack26_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack26_mha_d_x2,N,"B/bp,Seq,H,D",1,stack26_mha_d_q,stack26_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack26_mha_d_x3,N,"B/bp,Seq,H,D",1,stack26_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack26_mha_d_x01,N,"B/bp,Seq,H,D",1,stack26_mha_d_x0,stack26_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack26_mha_d_x23,N,"B/bp,Seq,H,D",1,stack26_mha_d_x2,stack26_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack26_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack27_mha_d_x01,stack27_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack26_ffn_d_res,N,"B/bp,Seq,D*H",1,stack26_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack26_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack26_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack26_ffn_d_w2,N,"DF*H,D*H",1,stack26_ffn_d_x2,stack26_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack26_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack26_ffn_d_x2,stack26_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack26_ffn_d_w1,N,"D*H,DF*H",1,stack26_ffn_d_x2,stack26_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack26_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack26_ffn_d_x1,stack26_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack26_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack26_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack27_mha_d_norm,N,"B/bp,Seq,H,D",1,stack27_ffn_d_x00,stack27_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack27_mha_d_res,N,"B/bp,Seq,H,D",1,stack27_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack27_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack27_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack27_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack27_mha_d_qkv,stack27_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack27_mha_d_v,N,"B/bp,Seq,H,D",1,stack27_mha_d_qkv,stack27_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack27_mha_d_k,N,"B/bp,Seq,H,D",1,stack27_mha_d_qk,stack27_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack27_mha_d_q,N,"B/bp,Seq,H,D",1,stack27_mha_d_qk,stack27_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack27_mha_d_wv,N,"H,D,D",1,stack27_mha_d_v,stack27_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack27_mha_d_wk,N,"H,D,D",1,stack27_mha_d_k,stack27_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack27_mha_d_wq,N,"H,D,D",1,stack27_mha_d_q,stack27_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack27_mha_d_x0,N,"B/bp,Seq,H,D",1,stack27_mha_d_v,stack27_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack27_mha_d_x1,N,"B/bp,Seq,H,D",1,stack27_mha_d_k,stack27_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack27_mha_d_x2,N,"B/bp,Seq,H,D",1,stack27_mha_d_q,stack27_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack27_mha_d_x3,N,"B/bp,Seq,H,D",1,stack27_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack27_mha_d_x01,N,"B/bp,Seq,H,D",1,stack27_mha_d_x0,stack27_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack27_mha_d_x23,N,"B/bp,Seq,H,D",1,stack27_mha_d_x2,stack27_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack27_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack28_mha_d_x01,stack28_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack27_ffn_d_res,N,"B/bp,Seq,D*H",1,stack27_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack27_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack27_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack27_ffn_d_w2,N,"DF*H,D*H",1,stack27_ffn_d_x2,stack27_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack27_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack27_ffn_d_x2,stack27_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack27_ffn_d_w1,N,"D*H,DF*H",1,stack27_ffn_d_x2,stack27_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack27_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack27_ffn_d_x1,stack27_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack27_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack27_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack28_mha_d_norm,N,"B/bp,Seq,H,D",1,stack28_ffn_d_x00,stack28_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack28_mha_d_res,N,"B/bp,Seq,H,D",1,stack28_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack28_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack28_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack28_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack28_mha_d_qkv,stack28_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack28_mha_d_v,N,"B/bp,Seq,H,D",1,stack28_mha_d_qkv,stack28_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack28_mha_d_k,N,"B/bp,Seq,H,D",1,stack28_mha_d_qk,stack28_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack28_mha_d_q,N,"B/bp,Seq,H,D",1,stack28_mha_d_qk,stack28_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack28_mha_d_wv,N,"H,D,D",1,stack28_mha_d_v,stack28_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack28_mha_d_wk,N,"H,D,D",1,stack28_mha_d_k,stack28_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack28_mha_d_wq,N,"H,D,D",1,stack28_mha_d_q,stack28_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack28_mha_d_x0,N,"B/bp,Seq,H,D",1,stack28_mha_d_v,stack28_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack28_mha_d_x1,N,"B/bp,Seq,H,D",1,stack28_mha_d_k,stack28_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack28_mha_d_x2,N,"B/bp,Seq,H,D",1,stack28_mha_d_q,stack28_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack28_mha_d_x3,N,"B/bp,Seq,H,D",1,stack28_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack28_mha_d_x01,N,"B/bp,Seq,H,D",1,stack28_mha_d_x0,stack28_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack28_mha_d_x23,N,"B/bp,Seq,H,D",1,stack28_mha_d_x2,stack28_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack28_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack29_mha_d_x01,stack29_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack28_ffn_d_res,N,"B/bp,Seq,D*H",1,stack28_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack28_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack28_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack28_ffn_d_w2,N,"DF*H,D*H",1,stack28_ffn_d_x2,stack28_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack28_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack28_ffn_d_x2,stack28_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack28_ffn_d_w1,N,"D*H,DF*H",1,stack28_ffn_d_x2,stack28_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack28_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack28_ffn_d_x1,stack28_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack28_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack28_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack29_mha_d_norm,N,"B/bp,Seq,H,D",1,stack29_ffn_d_x00,stack29_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack29_mha_d_res,N,"B/bp,Seq,H,D",1,stack29_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack29_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack29_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack29_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack29_mha_d_qkv,stack29_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack29_mha_d_v,N,"B/bp,Seq,H,D",1,stack29_mha_d_qkv,stack29_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack29_mha_d_k,N,"B/bp,Seq,H,D",1,stack29_mha_d_qk,stack29_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack29_mha_d_q,N,"B/bp,Seq,H,D",1,stack29_mha_d_qk,stack29_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack29_mha_d_wv,N,"H,D,D",1,stack29_mha_d_v,stack29_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack29_mha_d_wk,N,"H,D,D",1,stack29_mha_d_k,stack29_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack29_mha_d_wq,N,"H,D,D",1,stack29_mha_d_q,stack29_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack29_mha_d_x0,N,"B/bp,Seq,H,D",1,stack29_mha_d_v,stack29_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack29_mha_d_x1,N,"B/bp,Seq,H,D",1,stack29_mha_d_k,stack29_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack29_mha_d_x2,N,"B/bp,Seq,H,D",1,stack29_mha_d_q,stack29_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack29_mha_d_x3,N,"B/bp,Seq,H,D",1,stack29_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack29_mha_d_x01,N,"B/bp,Seq,H,D",1,stack29_mha_d_x0,stack29_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack29_mha_d_x23,N,"B/bp,Seq,H,D",1,stack29_mha_d_x2,stack29_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack29_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack30_mha_d_x01,stack30_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack29_ffn_d_res,N,"B/bp,Seq,D*H",1,stack29_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack29_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack29_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack29_ffn_d_w2,N,"DF*H,D*H",1,stack29_ffn_d_x2,stack29_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack29_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack29_ffn_d_x2,stack29_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack29_ffn_d_w1,N,"D*H,DF*H",1,stack29_ffn_d_x2,stack29_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack29_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack29_ffn_d_x1,stack29_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack29_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack29_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack30_mha_d_norm,N,"B/bp,Seq,H,D",1,stack30_ffn_d_x00,stack30_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack30_mha_d_res,N,"B/bp,Seq,H,D",1,stack30_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack30_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack30_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack30_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack30_mha_d_qkv,stack30_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack30_mha_d_v,N,"B/bp,Seq,H,D",1,stack30_mha_d_qkv,stack30_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack30_mha_d_k,N,"B/bp,Seq,H,D",1,stack30_mha_d_qk,stack30_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack30_mha_d_q,N,"B/bp,Seq,H,D",1,stack30_mha_d_qk,stack30_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack30_mha_d_wv,N,"H,D,D",1,stack30_mha_d_v,stack30_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack30_mha_d_wk,N,"H,D,D",1,stack30_mha_d_k,stack30_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack30_mha_d_wq,N,"H,D,D",1,stack30_mha_d_q,stack30_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack30_mha_d_x0,N,"B/bp,Seq,H,D",1,stack30_mha_d_v,stack30_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack30_mha_d_x1,N,"B/bp,Seq,H,D",1,stack30_mha_d_k,stack30_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack30_mha_d_x2,N,"B/bp,Seq,H,D",1,stack30_mha_d_q,stack30_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack30_mha_d_x3,N,"B/bp,Seq,H,D",1,stack30_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack30_mha_d_x01,N,"B/bp,Seq,H,D",1,stack30_mha_d_x0,stack30_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack30_mha_d_x23,N,"B/bp,Seq,H,D",1,stack30_mha_d_x2,stack30_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack30_ffn_d_norm,N,"B/bp,Seq,D*H",1,stack31_mha_d_x01,stack31_mha_d_x23,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack30_ffn_d_res,N,"B/bp,Seq,D*H",1,stack30_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack30_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack30_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack30_ffn_d_w2,N,"DF*H,D*H",1,stack30_ffn_d_x2,stack30_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack30_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack30_ffn_d_x2,stack30_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack30_ffn_d_w1,N,"D*H,DF*H",1,stack30_ffn_d_x2,stack30_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack30_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack30_ffn_d_x1,stack30_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack30_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack30_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack31_mha_d_norm,N,"B/bp,Seq,H,D",1,stack31_ffn_d_x00,stack31_ffn_d_x01,A,,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack31_mha_d_res,N,"B/bp,Seq,H,D",1,stack31_mha_d_norm,,E,10,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,10*B*D*H*Seq/bp
stack31_mha_d_qkv,N,"B/bp,Seq,H,D",1,stack31_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack31_mha_d_qk,N,"B/bp,Seq,Seq,H",1,stack31_mha_d_qkv,stack31_mha_v,M,"bshd,bwhd->bswh","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",D,,B*D*H*Seq**2/bp
stack31_mha_d_v,N,"B/bp,Seq,H,D",1,stack31_mha_d_qkv,stack31_mha_qk,M,"bshd,bswh->bwhd","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack31_mha_d_k,N,"B/bp,Seq,H,D",1,stack31_mha_d_qk,stack31_mha_q,M,"bswh,bshd->bwhd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack31_mha_d_q,N,"B/bp,Seq,H,D",1,stack31_mha_d_qk,stack31_mha_k,M,"bswh,bwhd->bshd","B/bp,Seq,Seq,H",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",Seq,,B*D*H*Seq**2/bp
stack31_mha_d_wv,N,"H,D,D",1,stack31_mha_d_v,stack31_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack31_mha_d_wk,N,"H,D,D",1,stack31_mha_d_k,stack31_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack31_mha_d_wq,N,"H,D,D",1,stack31_mha_d_q,stack31_mha_x,M,"bshe,bshd->hde","B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"H,D,D","B/bp,Seq",AllReduce@H*D*D,B*D**2*H*Seq/bp
stack31_mha_d_x0,N,"B/bp,Seq,H,D",1,stack31_mha_d_v,stack31_mha_wv,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack31_mha_d_x1,N,"B/bp,Seq,H,D",1,stack31_mha_d_k,stack31_mha_wk,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack31_mha_d_x2,N,"B/bp,Seq,H,D",1,stack31_mha_d_q,stack31_mha_wq,M,"bshe,hde->bshd","B/bp,Seq,H,D",1.00000000000000,"H,D,D",1.00000000000000,"B/bp,Seq,H,D",D,,B*D**2*H*Seq/bp
stack31_mha_d_x3,N,"B/bp,Seq,H,D",1,stack31_mha_d_res,,E,1,"B/bp,Seq,H,D",1.00000000000000,,,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack31_mha_d_x01,N,"B/bp,Seq,H,D",1,stack31_mha_d_x0,stack31_mha_d_x1,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack31_mha_d_x23,N,"B/bp,Seq,H,D",1,stack31_mha_d_x2,stack31_mha_d_x3,A,,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1.00000000000000,"B/bp,Seq,H,D",1,,B*D*H*Seq/bp
stack31_ffn_d_norm,N,"B/bp,Seq,D*H",1,,,T,,,,,,"B/bp,Seq,D*H",1,,
stack31_ffn_d_res,N,"B/bp,Seq,D*H",1,stack31_ffn_d_norm,,E,10,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,10*B*D*H*Seq/bp
stack31_ffn_d_x2,N,"B/bp,Seq,D*H",1,stack31_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
stack31_ffn_d_w2,N,"DF*H,D*H",1,stack31_ffn_d_x2,stack31_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"DF*H,D*H","B/bp,Seq",AllReduce@H*DF*H*D,B*D*DF*H**2*Seq/bp
stack31_ffn_d_x1,N,"B/bp,Seq,DF*H",1,stack31_ffn_d_x2,stack31_ffn_w2,M,"bse,de->bsd","B/bp,Seq,D*H",1.00000000000000,"DF*H,D*H",1.00000000000000,"B/bp,Seq,DF*H",D*H,,B*D*DF*H**2*Seq/bp
stack31_ffn_d_w1,N,"D*H,DF*H",1,stack31_ffn_d_x2,stack31_ffn_x1,M,"bse,bsd->de","B/bp,Seq,D*H",1.00000000000000,"B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H","B/bp,Seq",AllReduce@H*D*H*DF,B*D*DF*H**2*Seq/bp
stack31_ffn_d_x00,N,"B/bp,Seq,D*H",1,stack31_ffn_d_x1,stack31_ffn_w1,M,"bse,de->bsd","B/bp,Seq,DF*H",1.00000000000000,"D*H,DF*H",1.00000000000000,"B/bp,Seq,D*H",DF*H,,B*D*DF*H**2*Seq/bp
stack31_ffn_d_x01,N,"B/bp,Seq,D*H",1,stack31_ffn_d_res,,E,1,"B/bp,Seq,D*H",1.00000000000000,,,"B/bp,Seq,D*H",1,,B*D*H*Seq/bp
